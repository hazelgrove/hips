%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% standard header
    \documentclass[11pt]{article}
    \usepackage[margin=1.5cm]{geometry}
    \usepackage[utf8x]{inputenc} % for utf8
    \usepackage{titlesec} % see below
    \usepackage{xcolor} % \color \textcolor
    \usepackage{hyperref} % \href
    \usepackage[normalem]{ulem} % normalem retains \emph as italic
    % \uline \uuline \uwave \sout
    \usepackage{enumitem}
    % \begin{enumerate}[label=\Alpha*.]
    % \begin{enumerate}[label=\roman*.]
    % \begin{itemize}
    \usepackage{graphicx}
    % \includegraphicswidth=0.5\textwidth,trim=[0cm 0cm 0cm 0cm,clip]{file.png}
    \usepackage{pdfpages} % \includepdf[pages=1]{file.pdf}
    % for prose
    %\usepackage[doublespacing]{setspace}
    \usepackage{csquotes} % \blockquote
    \usepackage{xparse} % \NewDocumentCommand{\name}{O{#1 default}mO{#3 default}}{def}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \renewcommand{\rmdefault}{cmr}
    \renewcommand{\sfdefault}{cmss}
    \renewcommand{\ttdefault}{cmtt}
    \renewcommand{\familydefault}{\rmdefault}
    \setlength{\titlewidth}{\textwidth}

    \titlespacing{\section}{0pt}{0pt}{0pt}
    \titlespacing{\subsection}{0pt}{0pt}{0pt}
    \titlespacing{\subsubsection}{0pt}{0pt}{0pt}
    \titlespacing{\paragraph}{0pt}{0pt}{0pt}
    % https://www.overleaf.com/learn/latex/How_to_write_a_LaTeX_class_file_and_design_your_own_CV_(Part_1)
    % \titleformat{command}[shape]{format}{label}{sep}{before-code}[after-code]
    \titleformat{\section}         % Customise the \section command
        [hang]
        {\Large\scshape\raggedright} % Make the \section headers large (\Large),
                                   % small capitals (\scshape) and left aligned (\raggedright)
        {}{0em}                      % Can be used to give a prefix to all sections, like 'Section ...'
        {}                           % Can be used to insert code before the heading
        [\titlerule]                 % Inserts a horizontal line after the heading
    \titleformat{\subsection}
        [hang]
        {\large\scshape\raggedright}
        {}{0em}
        {}
        []
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% packages
    \usepackage{hejohns-hazel}
% commands
    \newcommand*{\vt}{~\vert~}
% automatically label rules
% (will give actual names sometime)
    \newcounter{counter}
    \refstepcounter{counter}
    \newcommand*{\hyph}{\text{-}}
    \renewcommand*{\rule}[1][(\thecounter)\refstepcounter{counter}]{\inferrule*[vcenter,rightstyle=\texttt,right=$\mathtt{#1}$]}
% get rid of 10-modules stuff
    \RenewDocumentCommand{\TypVarCtx}{oO{}}{\Phi_{#2}}
    \RenewDocumentCommand{\InTypVarCtx}{oO{}O{\knd}}{\TypVarCtx[][1],\typvar[#2]\KndAssump{#3},\TypVarCtx[][2]}
    \RenewDocumentCommand{\ExtendTypVarCtx}{ooO{\knd}}{\TypVarCtx[],\typvar[#2]\KndAssump{#3}#1}
    \renewcommand*{\ModVarCtx}[1][]{}
    \renewcommand*{\SigVarCtx}[1][]{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\pagenumbering{gobble}
\nonfrenchspacing
%\frenchspacing % when monospaced
\begin{document}
\title{Hazel Phi: 11-type-constructors}
\author{}
\date{\today}
\maketitle
\section{syntax}
    \begin{longtable}{RCRL}
        \textrm{Kind} & \knd & ::=
                      & \Type \vt \KHole \vt \SKind \vt \DepFunKind \\
        \textrm{User Types} & \utyp & ::=
                            & \utypvar \vt \bse \vt \ubinop \vt \ETypeHole \vt \NETypeHole[\utyp] \vt \TypeFun[][\Type][\utyp] \vt \TypeAp[\utyp[1]][\utyp[2]] \\
        \textrm{Internal Types} & \typ & ::=
                            & \typvar \vt \bse \vt \binop \vt \ETypeHole \vt \NETypeHole \vt \UnboundTypeVar \vt \TypeFun \vt \TypeAp \\
        \textrm{Base Types} & \bse & ::=
                            & \Int \vt \Float \vt \Bool \\
        \textrm{BinOp} & \binop[][] & ::=
                  & \ProdType \vt \SumType \vt \FunType \\
        \textrm{Type Pattern} & \\
        \textrm{User Expression} & \\
        \textrm{Internal Expression} & \\
    \end{longtable}
\section{Declaratives}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\PrincipalKind{\typ}}{$\typ$ has principal (well formed) kind $\knd$}
            \begin{mathpar}
                \rule[PK\hyph Base]{\ContextWellFormed}{\PrincipalKind{\bse}[\SKind[\Type][\bse]]}
                \and
                \rule[PK\hyph Var]{\ContextWellFormed[\HoleCtx\InTypVarCtx]}{\PrincipalKind{\typvar}[\SKind[\knd][\typvar]]}
                \and
                \rule[PK\hyph \oplus]{\WellFormedAtKind{\typ[1]}[\Type] \\ \WellFormedAtKind{\typ[2]}[\Type]}{\PrincipalKind{\binop}[\SKind[\Type][\binop]]}
                \and
                \rule[PK\hyph EHole]{\ContextWellFormed[\InTypHoleCtx\TypVarCtx]}{\PrincipalKind{\ETypeHole}[\SKind[\knd][\ETypeHole]]}
                \and
                \rule[PK\hyph NEHole]{\ContextWellFormed[\InTypHoleCtx\TypVarCtx] \\ \WellFormedAtKind{\typ}[\knd[1]]}{\PrincipalKind{\NETypeHole}[\SKind[\knd][\NETypeHole]]}
                \and
                \rule[PK\hyph Unbound]{\ContextWellFormed[\InTypHoleCtx\TypVarCtx] \\ \typvar\notin\dom{\TypVarCtx[]}}{\PrincipalKind{\UnboundTypeVar}[\SKind[\knd][\UnboundTypeVar]]}
                \and
                \rule[PK\hyph \lambda]{\PrincipalKind[\HoleCtx\ExtendTypVarCtx[][][{\knd[1]}]]{\typ}[\knd[2]]}{\PrincipalKind{\TypeFun[][\knd[1]]}[\SKind[\DepFunKind][\TypeFun[][\knd[1]]]]}
                \and
                \rule[PK\hyph Ap]{\PrincipalKind{\typ[1]} \\ \MatchedPiKind{\knd} \\ \WellFormedAtKind{\typ[2]}[\knd[1]]}{\PrincipalKind{\TypeAp}[\subst{\typ[2]}{\typvar}{\knd[2]}]}
            \end{mathpar}
        \end{minipage}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\WellFormedAtKind{\typ}}{$\typ$ is well formed at kind $\knd$}
            \begin{mathpar}
                \rule[WFaK\hyph 1]{\PrincipalKind{\typ}[\SKind[\knd][\typ]]}{\WellFormedAtKind{\typ}}
                \and
                \rule[WFaK\hyph Subsump]{\PrincipalKind{\typ}[\knd[1]] \\ \ConsistentSubKind{\knd[1]}{\knd}}{\WellFormedAtKind{\typ}}
                \\
                \mprset{myfraction=\inferruledotfrac}
                \rule[WFaK\hyph Reit]{\PrincipalKind{\typ}}{\WellFormedAtKind{\typ}}
                \and
                \rule[WFaK\hyph Self]{\WellFormedAtKind{\typ}}{\WellFormedAtKind{\typ}[\SKind[\knd][\typ]]}
                \and
                \rule[WFaK\hyph \Pi CSKTrans]{\WellFormedAtKind{\typ}[\DepFunKind[][\knd[3]][\knd[4]]] \\ \ConsistentSubKind{\DepFunKind[][\knd[3]][\knd[4]]}{\DepFunKind}}{\WellFormedAtKind{\typ}[\DepFunKind]}
                \and
                \rule[WFaK\hyph Flatten]{\WellFormedAtKind{\typ}[\SKind[\knd][\typ[1]]] \\ \WellFormedAtKind{\typ[1]}}{\WellFormedAtKind{\typ}}
            \end{mathpar}
        \end{minipage}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\MatchedPiKind{\knd}}{$\knd$ has matched $\Pi$-kind $\DepFunKind$}
            \begin{mathpar}
                \rule[\MatchedPiKindOp\hyph KHole]{\ContextWellFormed}{\MatchedPiKind{\KHole}[\DepFunKind[][\KHole][\KHole]]}
                \and
                \rule[\MatchedPiKindOp\hyph SKHole]{\KindEquiv{\knd}{\SKind[\KHole]}}{\MatchedPiKind{\knd}[\DepFunKind[][\SKind[\KHole]][\SKind[\KHole][\TypeAp[\typ][\typvar]]]]}
                \and
                \rule[\MatchedPiKindOp\hyph \Pi]{\KindEquiv{\knd}{\DepFunKind}}{\MatchedPiKind{\knd}}
            \end{mathpar}
        \end{minipage}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\KindEquiv{\knd[1]}{\knd[2]}}{$\knd[1]$ is equivalent to $\knd[2]$}
            \begin{mathpar}
                \rule[KEquiv\hyph Refl]{\KindWellFormed}{\KindEquiv{\knd}{\knd}}
                \and
                \rule[KEquiv\hyph Symm]{\KindEquiv{\knd[2]}{\knd[1]}}{\KindEquiv{\knd[1]}{\knd[2]}}
                \and
                \rule[KEquiv\hyph Trans]{\KindEquiv{\knd[1]}{\knd[3]} \\ \KindEquiv{\knd[3]}{\knd[2]}}{\KindEquiv{\knd[1]}{\knd[2]}}
                \\
                \rule[KEquiv\hyph SKind_{SKind}]{\WellFormedAtKind{\typ}[\SKind[\knd][\typ[1]]]}{\KindEquiv{\SKind[\SKind[\knd][\typ[1]]][\typ]}{\SKind[\knd][\typ[1]]}}
                \and
                \rule[KEquiv\hyph SKind_{\Pi}]{\WellFormedAtKind{\typ}[\DepFunKind]}{\KindEquiv{\SKind[\DepFunKind][\typ]}{\DepFunKind[1][\knd[1]][\SKind[\subst{\typvar[1]}{\typvar}{\knd[2]}][\TypeAp[\typ][\typvar[1]]]]}}
                \and
                \rule[KEquiv\hyph \Pi]{\KindEquiv{\knd[1]}{\knd[2]} \\ \KindEquiv[\HoleCtx\TypVarCtx[],\typvar\KndAssump\knd[1]]{\knd[3]}{\knd[4]}}{\KindEquiv{\DepFunKind[][\knd[1]][\knd[2]]}{\DepFunKind[][\knd[3]][\knd[4]]}}
                \and
                \rule[KEquiv\hyph SKind]{\TypeEquivAtKind{\typ[1]}{\typ[2]}[\knd[1]] \\ \KindEquiv{\knd[1]}{\knd[2]}}{\KindEquiv{\SKind[\knd[1]][\typ[1]]}{\SKind[\knd[2]][\typ[2]]}}
            \end{mathpar}
        \end{minipage}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\ConsistentSubKind{\knd[1]}{\knd[2]}}{$\knd[1]$ is a consistent subkind of $\knd[2]$}
            \begin{mathpar}
                \rule[CSK\hyph KHoleL]{\KindWellFormed}{\ConsistentSubKind{\KHole}{\knd}}
                \and
                \rule[CSK\hyph KHoleR]{\KindWellFormed}{\ConsistentSubKind{\knd}{\KHole}}
                \and
                \rule[CSK\hyph SKind_{KHole}L]{\KindWellFormed[{\SKind[\KHole]}] \\ \KindWellFormed}{\ConsistentSubKind{\SKind[\KHole]}{\knd}}
                \and
                \rule[CSK\hyph SKind_{KHole}R]{\KindWellFormed \\ \KindWellFormed[{\SKind[\KHole]}]}{\ConsistentSubKind{\knd}{\SKind[\KHole]}}
                \\
                \rule[CSK\hyph KEquiv]{\KindEquiv{\knd[1]}{\knd[2]}}{\ConsistentSubKind{\knd[1]}{\knd[2]}}
                \and
                \rule[CSK\hyph Normal]{\KindEquiv{\knd[1]}{\knd[3]} \\ \ConsistentSubKind{\knd[3]}{\knd[4]} \\ \KindEquiv{\knd[4]}{\knd[2]}}{\ConsistentSubKind{\knd[1]}{\knd[2]}}
                \and
                \rule[CSK\hyph SKind]{\KindWellFormed[{\SKind}]}{\ConsistentSubKind{\SKind}{\knd}}
                \and
                \rule[CSK\hyph \Pi]{\ConsistentSubKind{\knd[3]}{\knd[1]} \\ \ConsistentSubKind[\HoleCtx\TypVarCtx,\typvar\KndAssump\knd[3]]{\knd[2]}{\knd[4]}}{\ConsistentSubKind{\DepFunKind}{\DepFunKind[][\knd[3]][\knd[4]]}}
                \\
                \mprset{myfraction=\inferruledotfrac}
                \rule[CSK-?]{\ConsistentSubKind{\knd[1]}{\knd[2]} \\ \TypeEquivAtKind{\typ[1]}{\typ[2]}[\knd[1]]}{\ConsistentSubKind{\SKind[\knd[1]][\typ[1]]}{\SKind[\knd[2]][\typ[2]]}}
            \end{mathpar}
        \end{minipage}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\TypeEquivAtKind{\typ[1]}{\typ[2]}}{$\typ[1]$ is provably equivalent to $\typ[2]$ at kind $\knd$}
            \begin{mathpar}
                \rule[EquivAK\hyph Refl]{\WellFormedAtKind{\typ}}{\TypeEquivAtKind{\typ}{\typ}}
                \and
                \rule[EquivAK\hyph Symm]{\TypeEquivAtKind{\typ[2]}{\typ[1]}}{\TypeEquivAtKind{\typ[1]}{\typ[2]}}
                \and
                \rule[EquivAK\hyph Trans]{\TypeEquivAtKind{\typ[1]}{\typ[3]} \\ \TypeEquivAtKind{\typ[3]}{\typ[1]}}{\TypeEquivAtKind{\typ[1]}{\typ[2]}}
                \\
                \rule[EquivAK\hyph SKind]{\PrincipalKind{\typ[1]}[\knd[1]] \\ \KindEquiv{\knd[1]}{\SKind[\knd][\typ[2]]}}{\TypeEquivAtKind{\typ[1]}{\typ[2]}[\knd]}
                \and
                \rule[EquivAK\hyph\Pi]{\WellFormedAtKind{\typ[1]}[\DepFunKind[][\knd[1]][\knd[3]]] \\ \WellFormedAtKind{\typ[2]}[\DepFunKind[][\knd[1]][\knd[4]]] \\ \TypeEquivAtKind[\HoleCtx\TypVarCtx,\typvar\KndAssump\knd[1]]{\TypeAp[\typ[1]][\typvar]}{\TypeAp[\typ[2]][\typvar]}[\knd[2]]}{\TypeEquivAtKind{\typ[1]}{\typ[2]}[\DepFunKind]}
                \and
                \rule[EquivAK\hyph Ap]{\TypeEquivAtKind{\typ[1]}{\typ[3]}[\DepFunKind] \\ \TypeEquivAtKind{\typ[2]}{\typ[4]}[\knd[1]]}{\TypeEquivAtKind{\TypeAp}{\TypeAp[\typ[3]][\typ[4]]}[\subst{\typ[2]}{\typvar}{\knd[2]}]}
                \\
                \mprset{myfraction=\inferruledotfrac}
                \and
                \rule{\TypeEquivAtKind{\typ[1]}{\typ[2]}[\SKind]}{\TypeEquivAtKind{\typ[1]}{\typ[2]}}
                \\
                \mprset{myfraction=\inferruledotfrac}
                \rule{\TypeEquivAtKind{\typ[1]}{\typ[3]}[\Type] \\ \TypeEquivAtKind{\typ[2]}{\typ[4]}[\Type]}{\TypeEquivAtKind{\binop}{\binop[\typ[3]][\typ[4]]}[\Type]}
                \and
                \rule{\KindEquiv{\knd[1]}{\knd[2]} \\ \TypeEquivAtKind[\HoleCtx\TypVarCtx[],\typvar\KndAssump\knd[1]]{\typ[1]}{\typ[2]}}{\TypeEquivAtKind{\TypeFun[][\knd[1]][\typ[1]]}{\TypeFun[][\knd[2]][\typ[2]]}[\DepFunKind[][\knd[1]][\knd]]}
                \and
                \rule{\TypeEquivAtKind{\typ[1]}{\typ[2]}[\knd[1]] \\ \KindEquiv{\knd[1]}{\knd}}{\TypeEquivAtKind{\typ[1]}{\typ[2]}}
            \end{mathpar}
        \end{minipage}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\KindWellFormed}{$\knd$ is well formed}
            \begin{mathpar}
                \rule[KWF\hyph Type]{\ContextWellFormed}{\KindWellFormed[\Type]}
                \and
                \rule[KWF\hyph KHole]{\ContextWellFormed}{\KindWellFormed[\KHole]}
                \and
                \rule[KWF\hyph SKind]{\WellFormedAtKind{\typ}}{\KindWellFormed[\SKind]}
                \and
                \rule[KWF\hyph\Pi]{\KindWellFormed[{\knd[1]}] \\ \KindWellFormed[{\knd[2]}][\HoleCtx\ExtendTypVarCtx[][][{\knd[1]}]]}{\KindWellFormed[\DepFunKind]}
            \end{mathpar}
        \end{minipage}
    \subsection*{}
        \begin{minipage}{\textwidth}
            \judgbox{\ContextWellFormed}{Context is well formed}
            \begin{mathpar}
                \rule[CWF\hyph Nil]{ }{\ContextWellFormed[;]}
                \and
                \rule[CWF\hyph TypVar]{\KindWellFormed}{\ContextWellFormed[\HoleCtx\TypVarCtx[],\typvar\KndAssump\knd]}
                \and
                \rule[CWF\hyph Hole]{\KindWellFormed}{\ContextWellFormed[\HoleCtx[],\hole\KndAssump\knd;\TypVarCtx[]]}
            \end{mathpar}
            Variables implicitly assumed to be fresh as necessary
        \end{minipage}
\section{Metatheory}
    \subsection*{}
    \begin{lemma}[Weakening]
        \vphantom{.}\\
        If $\J$ and $\ContextWellFormed[\HoleCtx\ExtendTypVarCtx[][L][\knd[L]]]$, then $\J[\HoleCtx\ExtendTypVarCtx[][L][\knd[L]]]$
        %If $\J$ and $\ContextWellFormed[\ExtendTypHoleCtx[;][L][\knd[L]]\TypVarCtx[]]$, then $\J[\ExtendTypHoleCtx[;][L][\knd[L]]\TypVarCtx[]]$
    \end{lemma}
    \begin{lemma}[Exchange]
        \vphantom{.}\\
        If $\J[\HoleCtx\TypVarCtx[],\typvar[L1]\KndAssump\knd[L1],\typvar[L2]\KndAssump\knd[L2]]$ and $\ContextWellFormed[\HoleCtx\ExtendTypVarCtx[][L2][\knd[L2]]]$, then $\J[\HoleCtx\TypVarCtx[],\typvar[L2]\KndAssump\knd[L2]\typvar[L1]\KndAssump\knd[L1]]$
    \end{lemma}
    \begin{lemma}[OK-PK]
        If $\PrincipalKind{\typ}$, then $\ContextWellFormed$ and $\KindWellFormed$
    \end{lemma}
    \begin{lemma}[OK-WFaK]
        If $\WellFormedAtKind{\typ}$, then $\ContextWellFormed$ and $\KindWellFormed$
    \end{lemma}
    \begin{lemma}[OK-MatchPi]
        If $\MatchedPiKind{\knd}$, then $\ContextWellFormed$ and $\KindWellFormed$ and $\KindWellFormed[\DepFunKind]$
    \end{lemma}
    \begin{lemma}[OK-KEquiv]
        If $\KindEquiv{\knd[1]}{\knd[2]}$, then $\ContextWellFormed$ and $\KindWellFormed[{\knd[1]}]$ and $\KindWellFormed[{\knd[2]}]$
    \end{lemma}
    \begin{lemma}[OK-CSK]
        If $\ConsistentSubKind{\knd[1]}{\knd[2]}$, then $\ContextWellFormed$ and $\KindWellFormed[{\knd[1]}]$ and $\KindWellFormed[{\knd[2]}]$
    \end{lemma}
    \begin{lemma}[OK-EquivAK]
        If $\TypeEquivAtKind{\typ[1]}{\typ[2]}$, then $\ContextWellFormed$ and $\WellFormedAtKind{\typ[1]}$ and $\WellFormedAtKind{\typ[2]}$ and $\KindWellFormed$
    \end{lemma}
    \begin{lemma}[OK-KWF]
        If $\KindWellFormed$, then $\ContextWellFormed$
    \end{lemma}
    \begin{lemma}[OK-Substitution]
        \vphantom{.}\\ If $\WellFormedAtKind{\typ[L]}[\knd[L1]]$ and $\KindWellFormed[{\knd[L2]}][\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]$, then $\ContextWellFormed$ and $\KindWellFormed[\subst{\typ[L]}{\typvar[L]}{\knd[L2]}]$ \\
        (induction on $\KindWellFormed[{\knd[L2]}][\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]$)
    \end{lemma}
    %\begin{lemma}[PK-Substitution]
    %    \vphantom{.}\\ If $\PrincipalKind{\typ[L1]}[\knd[L1]]$ and $\PrincipalKind[\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]{\typ[L2]}[\knd[L2]]$, then $\PrincipalKind{\subst{\typ[L1]}{\typvar[L]}{\typ[L2]}}[\subst{\typ[L1]}{\typvar[L]}{\knd[L2]}]$ \\
    %    (induction on $\PrincipalKind[\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]{\typ[L2]}[\knd[L2]]$)
    %\end{lemma}
    \begin{lemma}[K-Substitution]
        \vphantom{.}\\ If $\WellFormedAtKind{\typ[L1]}[\knd[L1]]$ and $\WellFormedAtKind[\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]{\typ[L2]}[\knd[L2]]$, then $\WellFormedAtKind{\subst{\typ[L1]}{\typvar[L]}{\typ[L2]}}[\subst{\typ[L1]}{\typvar[L]}{\knd[L2]}]$ \\
        (induction on $\WellFormedAtKind[\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]{\typ[L2]}[\knd[L2]]$)
    \end{lemma}
    \begin{proof}
        By simultaneous induction on derivations. \\
        The interesting cases per lemma: \\
        \begin{tabular*}{\textwidth}{lc@{\extracolsep{\fill}}ll}
            OK-PK.
                &(1)& $\WellFormedAtKind{\bse}[\SKind[\Type][\bse]]$ & by (9) \\
                & & $\WellFormedAtKind{\bse}[\Type]$ & by (10) \\
                &*& $\KindWellFormed[{\SKind[\Type][\bse]}]$ & by (43) \\
                &*& $\ContextWellFormed$ & by premiss \\
                &(8)& & bad \\
            OK-WFaK.
                &(12)& $\WellFormedAtKind{\typ[2]}$ & by (10) \\
                &*& $\KindWellFormed[{\SKind[\knd][\typ[2]]}]$ & by (43) \\
            OK-KEquiv.
                &(22)& $\PrincipalKind{\TypeAp[\typ][\typvar]}$ & \\
            OK-Substitution.
                &(41)& $\ContextWellFormed[\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]$ & premiss (41) \\
                & & $\KindWellFormed[{\knd[L1]}]$ & by subderivation premiss (46) \\
                &*& $\ContextWellFormed$ & by OK-KWF \\
                &*& $\KindWellFormed[\subst{\typ[L]}{\typvar[L]}{\Type}]$ & by (41) and degenerate subst \\
                &(43)& $\WellFormedAtKind[\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]{\typ}[\knd]$ & premiss (43) \\
                & & $\ContextWellFormed[\HoleCtx\ExtendTypVarCtx[][L][{\knd[L1]}]]$ & by OK-WFaK \\
                & & $\KindWellFormed[{\knd[L1]}]$ & by subderivation premiss (46) \\
                &*& $\ContextWellFormed$ & by OK-KWF \\
                & & $\WellFormedAtKind{\subst{\typ[L1]}{\typvar[L]}{\typ}}[\subst{\typ[L1]}{\typvar[L]}{\knd}]$ & by K-Substitution on premiss \\
                &*& $\KindWellFormed[\subst{\typ[L]}{\typvar[L]}{\SKind}]$ & by (43) \\
        \end{tabular*}
    \end{proof}
    \vphantom{.}
    \begin{lemma}[PK-Unicity]
        If $\PrincipalKind{\typ[L]}[\knd[L1]]$ and $\PrincipalKind{\typ[L]}[\knd[L2]]$ then ${\knd[L1]}$ is ${\knd[L2]}$
    \end{lemma}
    \begin{lemma}
        If $\PrincipalKind{\typ}[\knd[1]]$ and $\WellFormedAtKind{\typ}[\knd[2]]$, then $\ConsistentSubKind{\knd[1]}{\knd[2]}$
    \end{lemma}
    \begin{lemma}
        If $\ConsistentSubKind{\knd[1]}{\SKind[\knd[2]]}$, then $\ConsistentSubKind{\knd[1]}{\knd[2]}$
    \end{lemma}
\end{document}
